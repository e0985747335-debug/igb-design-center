æ‚¨è§€å¯Ÿå¾—å¾ˆå°ï¼Œåœ¨ **é ç®—èˆ‡åˆ†æ (`budgeting-module-view`)** è¦–åœ–ä¸­ï¼Œé›–ç„¶æˆ‘å€‘å·²ç¶“åŠ å…¥äº† Chart.js çš„é‚è¼¯ (`initializeBudgetVarianceChart`)ï¼Œä½†åœ¨æŸäº›è£ç½®æˆ–é¦–æ¬¡è¼‰å…¥æ™‚ï¼Œåœ–è¡¨å¯èƒ½å› ç‚ºå®¹å™¨å¤§å°å°šæœªç¢ºå®šè€Œç„¡æ³•æ­£ç¢ºéŸ¿æ‡‰å¼æ¸²æŸ“ã€‚

æˆ‘å€‘ä¾†é€²è¡Œä»¥ä¸‹å…©å€‹é—œéµçš„ä¿®æ­£å’Œå„ªåŒ–ï¼š

1.  **ä¿®æ­£ Chart.js åˆå§‹åŒ–æ™‚æ©Ÿï¼š** é›–ç„¶æˆ‘å€‘å·²ç¶“ä½¿ç”¨ `setTimeout`ï¼Œä½†æˆ‘å€‘å¯ä»¥é€šé **`window.requestAnimationFrame`** æˆ–åœ¨é¡¯ç¤º DOM ä¹‹å¾Œï¼Œå¼·åˆ¶è®“ Chart.js é‡æ–°ç¹ªè£½ (`.resize()`) ä¾†ç¢ºä¿å…¶éŸ¿æ‡‰æ€§ã€‚
2.  **ç‚ºåœ–è¡¨å®¹å™¨æ·»åŠ æœ€å°é«˜åº¦ï¼š** ç¢ºä¿åœ–è¡¨å®¹å™¨å§‹çµ‚æœ‰è¶³å¤ çš„é«˜åº¦ï¼Œå³ä½¿åœ¨ç§»å‹•è¨­å‚™ä¸Šä¹Ÿèƒ½æ­£ç¢ºé¡¯ç¤ºã€‚

### ğŸ› ï¸ ç¨‹å¼ç¢¼å„ªåŒ–ï¼šç¢ºä¿ Budgeting åœ–è¡¨çš„éŸ¿æ‡‰æ€§

æˆ‘å°‡æ›´æ–° `initializeBudgetVarianceChart` å‡½æ•¸ï¼Œä¸¦æª¢æŸ¥ç›¸é—œçš„ HTML çµæ§‹ã€‚

```html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGB ERP æ•¸ä½ä¼æ¥­å‘½ä»¤ä¸­å¿ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        /* ... (CSS æ¨£å¼ä¿æŒä¸è®Š) ... */
        :root { font-family: 'Inter', sans-serif; }
        .module-card { transition: all 0.3s ease; transform: scale(1); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        .module-card:hover { transform: scale(1.02); box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.5), 0 4px 6px -4px rgba(59, 130, 246, 0.5); border-color: #3b82f6; }
        @keyframes pulse-ring { 0% { transform: scale(0.33); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
        .core-pulse { animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .dashboard-card { transition: all 0.2s ease-in-out; border: 1px solid transparent; }
        .dashboard-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3), 0 4px 6px -4px rgba(37, 99, 235, 0.3); border-color: #3b82f6; }
        .nav-button { transition: all 0.2s; }
        .nav-button:hover { background-color: #374151; }
        /* åˆ—å°æ¨£å¼å„ªåŒ– (ä¿æŒä¸è®Š) */
        @media print { .print-hide, footer { display: none !important; } body { background-color: #fff !important; color: #000 !important; padding: 0 !important; margin: 0 !important; } .dashboard-card, .bg-gray-800, .bg-gray-900, .bg-gray-700, .bg-gray-600 { box-shadow: none !important; border: 1px solid #ccc !important; background-color: #fff !important; color: #000 !important; } .text-yellow-300, .text-indigo-300, .text-red-300, .text-green-300 { color: #000 !important; } .lg\:col-span-2 { grid-column: span 3 / span 3 !important; width: 100% !important; } canvas { max-width: 100%; } }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-4 md:p-8">

    <div id="app-container">

        <section id="main-menu-view" class="">
            <header class="mb-8 text-center">
                <h1 class="text-4xl md:text-5xl font-extrabold text-blue-400 tracking-tight">IGB ERP æ•¸ä½ä¼æ¥­å‘½ä»¤ä¸­å¿ƒ</h1>
                <p class="text-lg text-gray-400 mt-2">çµ±åˆæ•¸æ“šæµï¼Œé©…å‹•æ±ºç­–ï¼Œå¯¦ç¾å“è¶Šç‡Ÿé‹</p>
            </header>
            <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-gray-50 mb-6 border-b border-blue-500/50 pb-3"><svg class="inline w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>ç³»çµ±å…¨è²Œï¼šIGB æ•¸ä½ä¼æ¥­æ ¸å¿ƒ</h2>
                    <div class="flex flex-col items-center justify-center p-6 bg-gray-700/50 rounded-lg">
                        <div class="relative w-32 h-32 flex items-center justify-center mb-10"><span class="absolute inline-flex h-full w-full rounded-full bg-blue-500 opacity-75 core-pulse"></span><div class="relative inline-flex rounded-full h-28 w-28 bg-blue-600 flex flex-col items-center justify-center border-4 border-blue-400 shadow-xl"><span class="text-xl font-extrabold text-white">IGB</span><span class="text-xs font-medium text-blue-100 mt-1">å‘½ä»¤ä¸­å¿ƒ</span></div></div>
                        <div class="w-full flex justify-between text-center mb-6"><div class="text-sm font-medium text-green-400">æ•¸æ“šé©…å‹•æ±ºç­–</div><div class="text-sm font-medium text-yellow-400">å³æ™‚æ´å¯Ÿ</div></div>
                        <div class="w-full grid grid-cols-3 gap-3 text-center"><div class="p-2 bg-gray-600 rounded-md text-xs font-semibold">å‰ç«¯æ‡‰ç”¨ (Apps)</div><div class="p-2 bg-gray-600 rounded-md text-xs font-semibold">ç‰©è¯ç¶² (IoT)</div><div class="p-2 bg-gray-600 rounded-md text-xs font-semibold">å‚³çµ±ç³»çµ± (Legacy)</div></div>
                        <div class="mt-8 pt-4 border-t border-gray-600 w-full"><h3 class="text-lg font-semibold text-gray-300 mb-2">æ ¸å¿ƒåƒ¹å€¼ï¼šçµ±åˆèˆ‡å„ªåŒ–</h3><ul class="space-y-2 text-sm text-gray-400"><li class="flex items-center"><svg class="w-4 h-4 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.001 12.001 0 0012 21a12.001 12.001 0 008.618-3.016z"></path></svg>æ¥­å‹™æµç¨‹è‡ªå‹•åŒ– (BPA)</li><li class="flex items-center"><svg class="w-4 h-4 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>å–®ä¸€çœŸå¯¦æ•¸æ“šæº (Single Source of Truth)</li><li class="flex items-center"><svg class="w-4 h-4 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7v10M17 5v14m-12 0h12a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>è·¨éƒ¨é–€å”ä½œé€æ˜åŒ–</li></ul></div>
                    </div>
                </div>

                <div class="lg:col-span-2 bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-gray-50 mb-6 border-b border-blue-500/50 pb-3"><svg class="inline w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><path d="m3.3 7 8.7 5 9.1-5"/><path d="M12 22v-8"/><path d="m11.2 15-8.4-4.8"/><path d="m12.8 15 8.4-4.8"/></svg>æ•¸ä½åŒ–ä¼æ¥­çš„æ ¸å¿ƒæ¨¡çµ„ï¼</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-green-500 cursor-pointer" onclick="showView('finance')"><h3 class="text-xl font-semibold text-green-400 mb-1">è²¡å‹™ç®¡ç† (Finance)</h3><p class="text-sm text-gray-400">ç¸½å¸³ã€æ‡‰æ”¶/æ‡‰ä»˜ã€å›ºå®šè³‡ç”¢ã€é ç®—èˆ‡è²¡å‹™åˆ†æã€‚ç¢ºä¿æœƒè¨ˆæº–ç¢ºæ€§èˆ‡ç¾é‡‘æµå¥åº·ã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-yellow-500 cursor-pointer"><h3 class="text-xl font-semibold text-yellow-400 mb-1">ä¾›æ‡‰éˆç®¡ç† (SCM)</h3><p class="text-sm text-gray-400">æ¡è³¼ã€ä¾›æ‡‰å•†ç®¡ç†ã€åº«å­˜å„ªåŒ–åŠç‰©æµè¿½è¹¤ã€‚å¾æºé ­åˆ°äº¤ä»˜çš„å…¨æµç¨‹æ§åˆ¶ã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-red-500 cursor-pointer"><h3 class="text-xl font-semibold text-red-400 mb-1">ç”Ÿç”¢è£½é€  (Manufacturing)</h3><p class="text-sm text-gray-400">ç‰©æ–™æ¸…å–® (BOM)ã€å·¥å–®ç®¡ç†ã€ç”¢èƒ½è¦åŠƒ (MRP) åŠè»Šé–“åŸ·è¡Œç³»çµ± (MES) æ•´åˆã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-pink-500 cursor-pointer"><h3 class="text-xl font-semibold text-pink-400 mb-1">äººåŠ›è³‡æº (HR)</h3><p class="text-sm text-gray-400">å“¡å·¥è³‡æ–™ã€è€ƒå‹¤ç®¡ç†ã€è–ªè³‡è¨ˆç®—èˆ‡ç™¼æ”¾ã€ç¸¾æ•ˆè€ƒæ ¸åŠäººæ‰ç™¼å±•ã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-indigo-500 cursor-pointer"><h3 class="text-xl font-semibold text-indigo-400 mb-1">å®¢æˆ¶é—œä¿‚ç®¡ç† (CRM)</h3><p class="text-sm text-gray-400">éŠ·å”®æ©Ÿæœƒè¿½è¹¤ã€å®¢æˆ¶æœå‹™æ”¯æ´ã€è¡ŒéŠ·æ´»å‹•ç®¡ç†åŠå”®å¾Œæœå‹™ã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-blue-500 cursor-pointer"><h3 class="text-xl font-semibold text-blue-400 mb-1">å•†æ¥­æ™ºæ…§ (BI)</h3><p class="text-sm text-gray-400">æ•¸æ“šå€‰åº«ã€å ±è¡¨å„€è¡¨æ¿ã€æ•¸æ“šæŒ–æ˜èˆ‡é æ¸¬åˆ†æã€‚ç‚ºé«˜å±¤æ±ºç­–æä¾›æ”¯æŒã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-purple-500 cursor-pointer"><h3 class="text-xl font-semibold text-purple-400 mb-1">å°ˆæ¡ˆç®¡ç† (Project Mgmt)</h3><p class="text-sm text-gray-400">å°ˆæ¡ˆè¦åŠƒã€è³‡æºåˆ†é…ã€é€²åº¦è¿½è¹¤ã€æ™‚é–“è¡¨ç®¡ç†åŠæˆæœ¬æ§åˆ¶ã€‚</p></div>
                        <div class="module-card p-4 bg-gray-700 rounded-lg border-l-4 border-teal-500 cursor-pointer"><h3 class="text-xl font-semibold text-teal-400 mb-1">å€‰å„²ç®¡ç† (WMS)</h3><p class="text-sm text-gray-400">å…¥åº«ã€å‡ºåº«ã€ç›¤é»ã€å„²ä½ç®¡ç†åŠæ‰¹æ¬¡è¿½æº¯ã€‚æå‡å€‰åº«ä½œæ¥­æ•ˆç‡èˆ‡æº–ç¢ºæ€§ã€‚</p></div>
                    </div>
                </div>
            </main>
        </section>

        <section id="finance-module-view" class="hidden">
             <header class="mb-8 border-b border-gray-700 pb-4">
                <div class="flex items-center justify-between">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-green-400 tracking-tight flex items-center"><svg class="w-8 h-8 md:w-10 md:h-10 mr-3 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 19H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2z"/><path d="M17 9h2a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-2"/><rect x="7" y="13" width="6" height="4" rx="1"/></svg>IGB è²¡å‹™ç®¡ç†ä¸­å¿ƒ (Financial Dashboard)</h1>
                    <div class="flex space-x-4"><button onclick="exportFinancialReport()" class="flex items-center text-green-400 hover:text-green-300 transition duration-150 p-2 rounded-lg bg-gray-800 border border-green-500/50 print-hide"><svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9V2h12v7"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><path d="M6 14h12v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-7"/></svg>åŒ¯å‡ºå ±è¡¨ (PDF)</button><button onclick="showView('main-menu')" class="flex items-center text-blue-400 hover:text-blue-300 transition duration-150 p-2 rounded-lg bg-gray-800 border border-blue-500/50 print-hide"><svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>è¿”å› ERP ç¸½è¦½</button></div>
                </div>
                <p class="text-lg text-gray-400 mt-2">å³æ™‚ç›£æ§è²¡å‹™ç¸¾æ•ˆã€ç¾é‡‘æµèˆ‡é ç®—åŸ·è¡Œæƒ…æ³</p>
            </header>

            <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-yellow-500"><p class="text-sm font-medium text-gray-400">ç•¶å‰ç¾é‡‘é¤˜é¡</p><p class="text-3xl font-bold text-yellow-300 mt-1">$ 1,850,000</p><p class="text-xs text-gray-500 mt-2">è¼ƒä¸Šæœˆå¢é•·: +4.2%</p></div>
                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-indigo-500"><p class="text-sm font-medium text-gray-400">æ‡‰æ”¶å¸³æ¬¾ (AR)</p><p class="text-3xl font-bold text-indigo-300 mt-1">$ 450,000</p><p class="text-xs text-gray-500 mt-2">é€¾æœŸé‡‘é¡: $ 55,000</p></div>
                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-red-500"><p class="text-sm font-medium text-gray-400">æ‡‰ä»˜å¸³æ¬¾ (AP)</p><p class="text-3xl font-bold text-red-300 mt-1">$ 210,000</p><p class="text-xs text-gray-500 mt-2">éœ€åœ¨ 7 å¤©å…§æ”¯ä»˜: $ 75,000</p></div>
                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-green-500"><p class="text-sm font-medium text-gray-400">æ·¨åˆ©æ½¤ç‡ (YTD)</p><p class="text-3xl font-bold text-green-300 mt-1">15.8%</p><p class="text-xs text-gray-500 mt-2">ç›®æ¨™é”æˆç‡: 98%</p></div>
            </section>

            <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700 h-full print-hide">
                    <h2 class="text-2xl font-bold text-gray-50 mb-4 border-b border-gray-600 pb-3">è²¡å‹™æ¨¡çµ„å°èˆª</h2>
                    <nav class="space-y-3">
                        <a onclick="showView('gl')" class="nav-button flex items-center p-3 rounded-lg bg-gray-700 hover:text-blue-300 text-gray-300"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>ç¸½å¸³ (General Ledger)</a>
                        <a onclick="showView('ar')" class="nav-button flex items-center p-3 rounded-lg bg-gray-700 hover:text-indigo-400 text-gray-300"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>æ‡‰æ”¶å¸³æ¬¾ (Accounts Receivable)</a>
                        <a onclick="showView('ap')" class="nav-button flex items-center p-3 rounded-lg bg-gray-700 hover:text-red-400 text-gray-300"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2h-2"/><path d="M18 6h-8"/><path d="M18 10h-8"/><path d="M10 14h8"/></svg>æ‡‰ä»˜å¸³æ¬¾ (Accounts Payable)</a>
                        <a onclick="showView('fa')" class="nav-button flex items-center p-3 rounded-lg bg-gray-700 hover:text-yellow-400 text-gray-300"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M12 18h.01"/></svg>å›ºå®šè³‡ç”¢ (Fixed Assets)</a>
                        <a onclick="showView('budgeting')" class="nav-button flex items-center p-3 rounded-lg bg-gray-700 text-green-300 font-semibold border-2 border-green-500 cursor-pointer"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>é ç®—èˆ‡åˆ†æ (Budgeting)</a>
                    </nav>
                </div>
                <div class="lg:col-span-2 space-y-8">
                    <div class="dashboard-card bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700"><h2 class="text-xl font-bold text-gray-50 mb-4">éå» 6 å€‹æœˆç¾é‡‘æµé‡è¶¨å‹¢</h2><div class="h-64"><canvas id="cashFlowChart"></canvas></div></div>
                    <div class="dashboard-card bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                        <h2 class="text-xl font-bold text-gray-50 mb-4 flex items-center"><svg class="w-5 h-5 mr-2 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>å¾…è™•ç†è²¡å‹™æ´»å‹• (Action Required)</h2>
                        <ul class="space-y-3">
                            <li class="flex items-center justify-between p-3 bg-gray-700 rounded-lg"><div class="flex items-center"><span class="text-red-400 mr-3 text-lg font-bold">AP</span><div><p class="text-sm font-semibold">æ‡‰ä»˜å¸³æ¬¾ï¼šæ”¯ä»˜ä¾›æ‡‰å•† A é€¾æœŸç™¼ç¥¨ #1001</p><p class="text-xs text-gray-400">é‡‘é¡: $25,000 | æˆªæ­¢æ—¥: 2025/10/20</p></div></div><button onclick="showToast('å·²æäº¤æ”¯ä»˜è«‹æ±‚ï¼šä¾›æ‡‰å•† Aã€‚', 'success')" class="px-3 py-1 text-xs font-medium text-white bg-red-600 rounded-full hover:bg-red-700">ç«‹å³è™•ç†</button></li>
                            <li class="flex items-center justify-between p-3 bg-gray-700 rounded-lg"><div class="flex items-center"><span class="text-indigo-400 mr-3 text-lg font-bold">AR</span><div><p class="text-sm font-semibold">æ‡‰æ”¶å¸³æ¬¾ï¼šå®¢æˆ¶ B ä¿¡ç”¨é¡åº¦å¯©æ ¸</p><p class="text-xs text-gray-400">è«‹æ±‚é‡‘é¡: $100,000 | æäº¤æ—¥: 2025/10/25</p></div></div><button onclick="showToast('å®¢æˆ¶ B ä¿¡ç”¨é¡åº¦å·²æ ¸å‡†ã€‚', 'success')" class="px-3 py-1 text-xs font-medium text-white bg-blue-600 rounded-full hover:bg-blue-700">å¯©æ‰¹</button></li>
                            <li class="flex items-center justify-between p-3 bg-gray-700 rounded-lg"><div class="flex items-center"><span class="text-yellow-400 mr-3 text-lg font-bold">GL</span><div><p class="text-sm font-semibold">ç¸½å¸³ï¼šç­‰å¾…æ ¸å‡†çš„æ—¥è¨˜å¸³åˆ†éŒ„</p><p class="text-xs text-gray-400">ç­†æ•¸: 4 ç­† | ç¸½é‡‘é¡: $12,500</p></div></div><button onclick="showToast('ç¸½å¸³åˆ†éŒ„å·²è¼‰å…¥ï¼Œè«‹å¯©æ ¸ã€‚', 'warning')" class="px-3 py-1 text-xs font-medium text-white bg-yellow-600 rounded-full hover:bg-yellow-700">æŸ¥çœ‹</button></li>
                        </ul>
                    </div>
                </div>
            </main>
        </section>

        <section id="general-ledger-view" class="hidden">
            </section>

        <section id="ar-module-view" class="hidden">
            </section>

        <section id="ap-module-view" class="hidden">
            </section>

        <section id="fa-module-view" class="hidden">
            </section>

        <section id="budgeting-module-view" class="hidden">
            <header class="mb-8 border-b border-gray-700 pb-4">
                <div class="flex items-center justify-between">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-green-400 tracking-tight flex items-center">
                        <svg class="w-8 h-8 md:w-10 md:h-10 mr-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
                        IGB é ç®—èˆ‡åˆ†æä¸­å¿ƒ (Budgeting Center)
                    </h1>

                    <div class="flex space-x-4 print-hide">
                        <span class="text-sm text-gray-500 flex items-center">
                            <span onclick="showView('finance')" class="cursor-pointer hover:text-green-400">è²¡å‹™å„€è¡¨æ¿</span>
                            <span class="mx-2">/</span>
                            <span class="text-green-400 font-semibold">é ç®—èˆ‡åˆ†æ</span>
                        </span>
                        <button onclick="showView('finance')" class="flex items-center text-green-400 hover:text-green-300 transition duration-150 p-2 rounded-lg bg-gray-800 border border-green-500/50">
                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
                            è¿”å›
                        </button>
                    </div>
                </div>
                <p class="text-lg text-gray-400 mt-2">
                    å³æ™‚è¿½è¹¤é ç®—åŸ·è¡Œé€²åº¦ï¼Œåˆ†æç‡Ÿé‹æ”¯å‡ºèˆ‡æ”¶å…¥çš„å·®ç•°
                </p>
            </header>

            <section class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8">
                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-green-500">
                    <p class="text-sm font-medium text-gray-400">ç¸½é«”é ç®—é”æˆç‡ (YTD)</p>
                    <p class="text-3xl font-bold text-green-300 mt-1">98.5%</p>
                    <p class="text-xs text-gray-500 mt-2">ç›®æ¨™ï¼š100% (ç•¥ä½æ–¼ç›®æ¨™)</p>
                </div>

                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-red-500">
                    <p class="text-sm font-medium text-gray-400">ç¸½ç‡Ÿé‹è²»ç”¨å·®ç•°</p>
                    <p class="text-3xl font-bold text-red-300 mt-1">-$ 15,000</p>
                    <p class="text-xs text-gray-500 mt-2">ä¸åˆ©å·®ç•° (è¶…æ”¯)</p>
                </div>

                <div class="dashboard-card bg-gray-800 p-5 rounded-xl shadow-lg border-l-4 border-blue-500">
                    <p class="text-sm font-medium text-gray-400">ç¸½æ”¶å…¥å·®ç•°</p>
                    <p class="text-3xl font-bold text-blue-300 mt-1">+$ 50,000</p>
                    <p class="text-xs text-gray-500 mt-2">æœ‰åˆ©å·®ç•° (è¶…é¡é”æˆ)</p>
                </div>
            </section>

            <div class="dashboard-card bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 mb-8">
                <h2 class="text-xl font-bold text-gray-50 mb-4 flex items-center">
                    <svg class="inline w-5 h-5 mr-2 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20V10"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg>
                    ä¸»è¦éƒ¨é–€é ç®—å·®ç•°åˆ†æ (æœ¬æœˆ)
                </h2>
                <div class="h-80">
                    <canvas id="budgetVarianceChart"></canvas>
                </div>
            </div>

            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700 overflow-x-auto print-hide">
                <h2 class="text-xl font-bold text-gray-50 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20v-4"/><path d="M12 10V4"/><path d="M3 3l.63 2.02a4 4 0 0 0 3.12 2.76h10.5a4 4 0 0 0 3.12-2.76L21 3"/></svg>
                    é ç®—ç®¡ç†æ“ä½œ
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="showToast('å·²é–‹å§‹ 2026 å¹´é ç®—æ»¾å‹•é æ¸¬ç¨‹åºã€‚', 'success')" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150">
                        æ»¾å‹•é æ¸¬ (2026)
                    </button>
                    <button onclick="showToast('å·²è¼‰å…¥æœ€æ–°é ç®—å·®ç•°å ±å‘Šã€‚', 'info')" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150">
                        ä¸‹è¼‰å·®ç•°å ±å‘Š
                    </button>
                    <button onclick="showToast('å·²å„²å­˜æœ¬æœˆé ç®—èª¿æ•´ã€‚', 'warning')" class="bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150">
                        æäº¤é ç®—èª¿æ•´
                    </button>
                </div>
            </div>
        </section>


    </div>

    <div id="toast-container" class="fixed bottom-5 right-5 z-50 space-y-3 print-hide">
        </div>

    <footer class="mt-10 pt-4 border-t border-gray-700 text-center text-gray-500 text-sm">
        <p>IGB ERP ç³»çµ± â€” æ•¸ä½åŒ–è½‰å‹çš„è—åœ– | 2025 å¹´</p>
    </footer>

    <script>
        // ===============================================
        // Chart.js åˆå§‹åŒ–å‡½æ•¸ (å·²ä¿®æ­£éŸ¿æ‡‰å¼å•é¡Œ)
        // ===============================================
        let cashFlowChartInstance = null;
        let budgetVarianceChartInstance = null;

        function initializeCashFlowChart() {
            const ctx = document.getElementById('cashFlowChart');
            if (cashFlowChartInstance) { cashFlowChartInstance.destroy(); }
            const cashIn = [350000, 420000, 480000, 500000, 520000, 550000];
            const cashOut = [210000, 250000, 280000, 310000, 300000, 340000];
            const netCash = cashIn.map((c, i) => c - cashOut[i]);
            const chartData = {
                labels: ['å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ'],
                datasets: [
                    { label: 'ç¾é‡‘æµå…¥ (Cash In)', data: cashIn, borderColor: 'rgb(75, 192, 192)', backgroundColor: 'rgba(75, 192, 192, 0.2)', tension: 0.3, fill: true, yAxisID: 'y' },
                    { label: 'æ·¨ç¾é‡‘æµ (Net Flow)', data: netCash, borderColor: 'rgb(59, 130, 246)', backgroundColor: 'rgba(59, 130, 246, 0.4)', tension: 0.3, fill: false, yAxisID: 'y' },
                    { label: 'ç¾é‡‘æµå‡º (Cash Out)', data: cashOut, borderColor: 'rgb(239, 68, 68)', backgroundColor: 'rgba(239, 68, 68, 0.2)', tension: 0.3, fill: false, yAxisID: 'y', borderDash: [5, 5] }
                ]
            };
            cashFlowChartInstance = new Chart(ctx, {
                type: 'line', data: chartData, options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#d1d5db' } }, title: { display: false } },
                    scales: {
                        x: { ticks: { color: '#9ca3af' }, grid: { color: '#374151' } },
                        y: { beginAtZero: false, ticks: { color: '#9ca3af', callback: function(value, index, values) { return '$' + (value / 1000) + 'K'; } }, grid: { color: '#374151' } }
                    }
                }
            });
        }

        function initializeBudgetVarianceChart() {
            const ctx = document.getElementById('budgetVarianceChart');
            if (budgetVarianceChartInstance) { budgetVarianceChartInstance.destroy(); }

            // æ¨¡æ“¬é ç®—å·®ç•°æ•¸æ“š (æ­£æ•¸ç‚ºæœ‰åˆ©å·®ç•°/çœéŒ¢ï¼Œè² æ•¸ç‚ºä¸åˆ©å·®ç•°/è¶…æ”¯)
            const varianceData = [15000, -8000, 5000, -12000, 20000];
            const labels = ['ç ”ç™¼éƒ¨é–€', 'ç”Ÿç”¢è»Šé–“', 'å¸‚å ´è¡ŒéŠ·', 'è¡Œæ”¿ç®¡ç†', 'éŠ·å”®éƒ¨é–€'];

            budgetVarianceChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'é ç®—å·®ç•° (å¯¦éš› - é ç®—)',
                        data: varianceData,
                        backgroundColor: varianceData.map(v => v >= 0 ? 'rgba(74, 222, 128, 0.7)' : 'rgba(248, 113, 113, 0.7)'),
                        borderColor: varianceData.map(v => v >= 0 ? 'rgb(74, 222, 128)' : 'rgb(248, 113, 113)'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, labels: { color: '#d1d5db' } },
                        title: { display: false }
                    },
                    scales: {
                        x: { stacked: false, ticks: { color: '#9ca3af' }, grid: { color: '#374151' } },
                        y: {
                            ticks: {
                                color: '#9ca3af',
                                callback: function(value) { return value >= 0 ? '$' + value.toLocaleString() : '-$' + Math.abs(value).toLocaleString(); }
                            },
                            grid: { color: '#374151' },
                            title: { display: true, text: 'å·®ç•°é‡‘é¡ (TWD)', color: '#9ca3af' }
                        }
                    }
                }
            });
        }
        // ... (Toast and Export å‡½æ•¸ä¿æŒä¸è®Š) ...

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            let bgColor = 'bg-green-600';
            let iconSvg = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>';

            if (type === 'error') { bgColor = 'bg-red-600'; iconSvg = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" x2="9" y1="9" y2="15"/><line x1="9" x2="15" y1="9" y2="15"/></svg>'; }
            else if (type === 'warning') { bgColor = 'bg-yellow-600'; iconSvg = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>'; }
            else if (type === 'success') { bgColor = 'bg-green-600'; iconSvg = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M9 11l3 3L22 4"/></svg>'; }
            else if (type === 'info') { bgColor = 'bg-blue-600'; iconSvg = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'; }


            toast.className = `${bgColor} text-white p-4 rounded-lg shadow-xl flex items-center max-w-sm opacity-0 transition-opacity duration-300 transform translate-x-1/2`;
            toast.innerHTML = `${iconSvg}<span class="text-sm font-semibold">${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => { toast.classList.remove('opacity-0', 'translate-x-1/2'); toast.classList.add('opacity-100', 'translate-x-0'); }, 50);
            setTimeout(() => {
                toast.classList.remove('opacity-100', 'translate-x-0');
                toast.classList.add('opacity-0', 'translate-x-1/2');
                setTimeout(() => { if (container.contains(toast)) { container.removeChild(toast); } }, 300);
            }, 3000);
        }

        function exportFinancialReport() { window.print(); }

        function showView(viewId) {
            const views = {
                'main-menu': 'main-menu-view',
                'finance': 'finance-module-view',
                'gl': 'general-ledger-view',
                'ar': 'ar-module-view',
                'ap': 'ap-module-view',
                'fa': 'fa-module-view',
                'budgeting': 'budgeting-module-view'
            };

            const targetId = views[viewId];
            if (!targetId) {
                console.error(`Invalid viewId: ${viewId}`);
                return;
            }

            Object.values(views).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.add('hidden');
                }
            });

            const targetElement = document.getElementById(targetId);
            if (targetElement) {
                targetElement.classList.remove('hidden');
            } else {
                console.error(`Target view element not found for ID: ${targetId}`);
                return;
            }

            // è™•ç†åœ–è¡¨åˆå§‹åŒ–
            if (viewId === 'finance') {
                setTimeout(initializeCashFlowChart, 100);
            }

            if (viewId === 'budgeting') {
                // å„ªåŒ–åœ–è¡¨åˆå§‹åŒ–æ™‚æ©Ÿï¼šç¢ºä¿ DOM ç¹ªè£½å®Œç•¢å¾Œå†åˆå§‹åŒ–åœ–è¡¨
                window.requestAnimationFrame(() => {
                    initializeBudgetVarianceChart();
                    // åœ¨ Chart.js å¯¦ä¾‹å­˜åœ¨æ™‚ï¼Œå¼·åˆ¶è§¸ç™¼ä¸€æ¬¡ resize() ä»¥æ‡‰å° SPA æ¨¡å¼ä¸‹çš„åˆå§‹åŒ–å•é¡Œ
                    if (budgetVarianceChartInstance) {
                        budgetVarianceChartInstance.resize();
                    }
                });
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            showView('main-menu');
        });
    </script>

</body>
</html>
```
