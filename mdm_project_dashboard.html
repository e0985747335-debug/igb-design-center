<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDM 專案執行儀表板</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght=400;500;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: MDM Professional Dark Mode (Slate/Cyan Accent) -->
    <!-- Application Structure Plan: A fixed header introduces the project. The main content uses a two-column responsive grid layout (md:grid-cols-3) where the first column holds key status cards, and the other two columns house main charts (OS Distribution, Policy Status). A dedicated section below tracks the 4-phase project lifecycle and lists core policy groups, allowing user interaction to reveal detailed specs. The structure prioritizes quick status checks followed by deep-dive exploration. -->
    <!-- Visualization & Content Choices: 
        - Project Status: Goal: Inform. Method: KPI Cards (HTML/CSS). Justification: Provides immediate operational status.
        - OS Distribution: Goal: Inform Proportions. Method: Doughnut Chart (Chart.js/Canvas). Interaction: Tooltip. Justification: Clearly shows platform mix and the scope of management.
        - Policy Status: Goal: Compare. Method: Horizontal Bar Chart (Chart.js/Canvas). Interaction: Tooltip. Justification: Compares deployment success across different policy categories.
        - Phase Tracker: Goal: Organize/Track Progress. Method: Timeline Diagram (HTML/CSS/JS). Interaction: Click phase to show details. Justification: Clearly visualizes project execution status.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0f172a; /* Slate 900 - Dark Background */
        }
        .accent-cyan {
            color: #06b6d4; /* Cyan 500 */
        }
        .bg-accent-cyan {
            background-color: #0e7490; /* Cyan 700 */
        }
        .card {
            background-color: #1e293b; /* Slate 800 */
            transition: all 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            border-bottom-color: #06b6d4;
        }
        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 500px; /* Max width for chart */
            margin-left: auto; 
            margin-right: auto;
            height: 300px; /* Fixed height for consistency */
            max-height: 40vh;
        }
        @media (min-width: 1024px) {
            .chart-container {
                max-width: 90%;
            }
        }
        .timeline-dot {
            transition: all 0.3s;
            border: 4px solid #0f172a;
        }
        .timeline-item.active .timeline-dot {
            background-color: #06b6d4; /* Active Cyan */
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.4);
        }
    </style>
</head>
<body class="text-gray-100 p-0">

    <!-- Fixed Header -->
    <header class="sticky top-0 z-20 bg-slate-900/90 backdrop-blur-md border-b border-slate-700 shadow-xl px-8 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-extrabold text-white">
                <span class="accent-cyan">MDM</span> 專案戰情室
            </h1>
            <div id="project-status-pill" class="text-sm font-semibold rounded-full px-4 py-2 bg-green-700/50 border border-green-600 text-green-300">
                第三階段：政策部署中 (75%)
            </div>
        </div>
    </header>

    <!-- Main Content Grid -->
    <main class="p-4 md:p-8 max-w-7xl mx-auto">
        <p class="text-slate-400 mb-8 max-w-5xl">此儀表板提供 MDM 專案從規劃到部署的單一視圖。使用者可以一覽核心指標、設備分佈，並深度探索各階段的執行細節與政策規範。</p>

        <!-- KPI Cards Section -->
        <section id="kpi-status" class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
            <div class="kpi-card card p-5 rounded-xl border-b-4 border-slate-700 shadow-lg">
                <p class="text-sm text-slate-400 font-medium">總納管設備數</p>
                <p class="text-4xl font-bold text-white mt-2">12,580</p>
                <p class="text-xs text-green-400 mt-1">+850 本月新增</p>
            </div>
            <div class="kpi-card card p-5 rounded-xl border-b-4 border-slate-700 shadow-lg">
                <p class="text-sm text-slate-400 font-medium">整體合規率</p>
                <p class="text-4xl font-bold accent-cyan mt-2">94.7%</p>
                <p class="text-xs text-yellow-400 mt-1">目標: 95% (尚待提升)</p>
            </div>
            <div class="kpi-card card p-5 rounded-xl border-b-4 border-slate-700 shadow-lg">
                <p class="text-sm text-slate-400 font-medium">待解決違規事件</p>
                <p class="text-4xl font-bold text-red-500 mt-2">126</p>
                <p class="text-xs text-slate-400 mt-1">高風險事件: 18</p>
            </div>
            <div class="kpi-card card p-5 rounded-xl border-b-4 border-slate-700 shadow-lg">
                <p class="text-sm text-slate-400 font-medium">已部署政策組</p>
                <p class="text-4xl font-bold text-white mt-2">24 / 32</p>
                <p class="text-xs text-slate-400 mt-1">待發佈: 8 組 (Q4)</p>
            </div>
        </section>

        <!-- Charts and Visualizations Section -->
        <section id="visualizations" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            
            <!-- Chart 1: Device OS Distribution -->
            <div class="card p-6 rounded-xl shadow-2xl">
                <h2 class="text-xl font-bold text-white mb-4 border-b border-slate-700 pb-3">納管設備作業系統分佈</h2>
                <p class="text-sm text-slate-400 mb-4">清楚掌握不同平臺的設備數量，有助於資源分配與政策測試。</p>
                <div class="chart-container">
                    <canvas id="osDistributionChart"></canvas>
                </div>
            </div>

            <!-- Chart 2: Policy Deployment Status -->
            <div class="card p-6 rounded-xl shadow-2xl">
                <h2 class="text-xl font-bold text-white mb-4 border-b border-slate-700 pb-3">核心政策部署成功率 (Top 5)</h2>
                <p class="text-sm text-slate-400 mb-4">比較關鍵政策組在所有納管設備上的部署成功率，找出部署瓶頸。</p>
                <div class="chart-container">
                    <canvas id="policyStatusChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Project Timeline & Policy Details -->
        <section id="project-details" class="card p-8 rounded-xl shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-2">MDM 專案藍圖與關鍵政策</h2>
            <p class="text-slate-400 mb-8 max-w-5xl">透過時間軸追蹤專案進度，並點擊政策查看詳細的技術實施規格。</p>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Timeline/Phase Tracker -->
                <div class="lg:col-span-4 border-r border-slate-700 pr-6">
                    <h3 class="text-lg font-semibold accent-cyan mb-4">專案 4 階段追蹤</h3>
                    <div id="project-timeline" class="relative">
                        <!-- Items generated by JS -->
                    </div>
                </div>

                <!-- Interactive Policy List -->
                <div class="lg:col-span-8 pl-6">
                    <h3 class="text-lg font-semibold accent-cyan mb-4">核心政策規格</h3>
                    <div id="policy-list" class="space-y-4">
                        <!-- Policy items -->
                        <div class="bg-slate-700 p-4 rounded-lg cursor-pointer hover:bg-slate-600 transition-colors" data-policy="authentication">
                            <p class="font-bold text-lg">1. 零信任身份驗證 (ZTA)</p>
                            <p class="text-sm text-slate-400 mt-1" id="policy-desc-authentication">點擊查看詳情...</p>
                        </div>
                        <div class="bg-slate-700 p-4 rounded-lg cursor-pointer hover:bg-slate-600 transition-colors" data-policy="encryption">
                            <p class="font-bold text-lg">2. 設備全盤加密 (FDE)</p>
                            <p class="text-sm text-slate-400 mt-1" id="policy-desc-encryption">點擊查看詳情...</p>
                        </div>
                        <div class="bg-slate-700 p-4 rounded-lg cursor-pointer hover:bg-slate-600 transition-colors" data-policy="geofencing">
                            <p class="font-bold text-lg">3. 地域限制與圍欄 (Geofencing)</p>
                            <p class="text-sm text-slate-400 mt-1" id="policy-desc-geofencing">點擊查看詳情...</p>
                        </div>
                    </div>

                    <div id="policy-detail-panel" class="card p-6 rounded-xl border border-cyan-600 mt-6 hidden">
                        <h4 class="text-xl font-bold accent-cyan mb-3" id="detail-title"></h4>
                        <p class="text-sm text-slate-300" id="detail-content"></p>
                    </div>
                </div>
            </div>
        </section>
    </main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // --- Data Definitions ---
    const osData = {
        labels: ['iOS (企業配發)', 'Android (BYOD)', 'Windows 10/11 (筆電)'],
        data: [5200, 3800, 3580]
    };

    const policyData = {
        labels: ['ZTA (Auth)', 'FDE (Encrypt)', 'Anti-Virus', 'VPN Config', 'App Store Policy'],
        success: [98.5, 95.2, 99.1, 88.0, 96.5]
    };

    const projectPhases = [
        { phase: 'P1', title: '規劃與範圍定義', status: '完成' },
        { phase: 'P2', title: '平臺基礎設施部署', status: '完成' },
        { phase: 'P3', title: '政策設計與初次部署', status: '進行中' },
        { phase: 'P4', title: '全面推行與上線', status: '待開始' }
    ];

    const policyDetails = {
        'authentication': {
            title: '零信任身份驗證 (ZTA) 規範',
            content: '要求所有設備必須在安全邊界外，使用 MFA 搭配條件式存取 (Conditional Access) 進行驗證。必須確保裝置健康狀態 (Device Health) 通過 MDM 檢查。'
        },
        'encryption': {
            title: '設備全盤加密 (FDE) 規範',
            content: 'Windows 設備必須使用 BitLocker，iOS/Android 必須啟用原生加密。所有加密金鑰必須安全託管於 MDM 後臺。不允許使用弱加密協議。'
        },
        'geofencing': {
            title: '地域限制與圍欄 (Geofencing) 規範',
            content: '特定高機密資料的存取將受限於公司指定 IP 範圍或地理圍欄內。一旦設備離開安全區域，將自動觸發遠端擦除 (Remote Wipe) 警告。'
        }
    };

    // --- Chart 1: OS Distribution (Doughnut Chart) ---
    const osCtx = document.getElementById('osDistributionChart').getContext('2d');
    new Chart(osCtx, {
        type: 'doughnut',
        data: {
            labels: osData.labels,
            datasets: [{
                data: osData.data,
                backgroundColor: ['#06b6d4', '#60a5fa', '#f87171'], // Cyan, Blue, Red
                borderColor: '#1e293b',
                borderWidth: 5
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '70%',
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { color: '#cbd5e1', usePointStyle: true }
                },
                tooltip: {
                    backgroundColor: '#0f172a',
                    titleColor: '#fff',
                    bodyColor: '#cbd5e1',
                    padding: 10,
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed !== null) { label += context.parsed.toLocaleString() + ' 設備'; }
                            return label;
                        }
                    }
                }
            }
        }
    });

    // --- Chart 2: Policy Deployment Status (Horizontal Bar Chart) ---
    const policyCtx = document.getElementById('policyStatusChart').getContext('2d');
    new Chart(policyCtx, {
        type: 'bar',
        data: {
            labels: policyData.labels,
            datasets: [{
                label: '部署成功率 (%)',
                data: policyData.success,
                backgroundColor: policyData.success.map(rate => rate < 90 ? '#f87171' : '#06b6d4'),
                borderColor: '#1e293b',
                borderWidth: 1,
                borderRadius: 5
            }]
        },
        options: {
            indexAxis: 'y', // Horizontal bars
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    beginAtZero: true,
                    max: 100,
                    grid: { color: '#334155' },
                    ticks: { color: '#cbd5e1', callback: function(value) { return value + '%'; } }
                },
                y: {
                    grid: { display: false },
                    ticks: { color: '#cbd5e1' }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: '#0f172a',
                    titleColor: '#fff',
                    bodyColor: '#cbd5e1',
                    padding: 10
                }
            }
        }
    });

    // --- Timeline Rendering and Interaction ---
    const timelineContainer = document.getElementById('project-timeline');
    
    projectPhases.forEach((p, index) => {
        const item = document.createElement('div');
        const isActive = p.status === '進行中';
        item.className = `timeline-item relative mb-8 pl-10 ${isActive ? 'active' : ''}`;
        
        // Vertical line
        if (index < projectPhases.length - 1) {
            const line = document.createElement('div');
            line.className = 'absolute left-1.5 top-0 bottom-0 w-0.5 bg-slate-700';
            item.appendChild(line);
        }

        // Dot
        const dot = document.createElement('div');
        dot.className = `timeline-dot absolute -left-1 top-0 w-4 h-4 rounded-full ${p.status === '完成' ? 'bg-green-500' : p.status === '待開始' ? 'bg-slate-500' : 'bg-yellow-500'} z-10`;
        item.appendChild(dot);
        
        // Content
        const title = document.createElement('h4');
        title.className = 'font-semibold text-white';
        title.textContent = `${p.phase}: ${p.title}`;
        item.appendChild(title);

        const statusText = document.createElement('p');
        statusText.className = `text-sm mt-0.5 ${p.status === '完成' ? 'text-green-400' : p.status === '待開始' ? 'text-slate-400' : 'text-yellow-400'}`;
        statusText.textContent = `狀態: ${p.status}`;
        item.appendChild(statusText);

        timelineContainer.appendChild(item);
    });

    // --- Policy Detail Interaction ---
    const detailPanel = document.getElementById('policy-detail-panel');
    const detailTitle = document.getElementById('detail-title');
    const detailContent = document.getElementById('detail-content');
    const policyElements = document.querySelectorAll('#policy-list > div');

    policyElements.forEach(el => {
        el.addEventListener('click', function() {
            const policyKey = this.getAttribute('data-policy');
            const data = policyDetails[policyKey];

            // Update panel content
            detailTitle.textContent = data.title;
            detailContent.textContent = data.content;
            detailPanel.classList.remove('hidden');

            // Highlight active policy in the list
            policyElements.forEach(item => {
                item.classList.remove('bg-accent-cyan', 'border', 'border-cyan-400');
                item.classList.add('bg-slate-700');
            });
            this.classList.add('bg-accent-cyan', 'border', 'border-cyan-400');
            this.classList.remove('bg-slate-700');

            // Update placeholder text
            document.getElementById(`policy-desc-${policyKey}`).textContent = '已在右側面板中展開規格細節。';
        });
    });

});
</script>
</body>
</html>
