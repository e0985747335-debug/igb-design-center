開發程式指南：單一檔案響應式應用程式本指南專為在這個協作環境中（單一檔案、Tailwind CSS、Firebase 整合）開發高效、美觀且可維護的應用程式而設計。1. 總體設計原則 (General Principles)1.1 優先使用者體驗 (User Experience First)響應式設計 (Responsive First): 始終使用相對單位 (%, vw) 和 Tailwind 的響應式斷點（如 sm:, md:, lg:），確保應用程式在手機、平板和桌面裝置上都能完美運作。美觀與可用性 (Aesthetics & Usability): 介面必須美觀且易於使用。使用圓角、陰影和清晰的色彩對比。無障礙設計 (Accessibility): 確保所有互動元素（按鈕、輸入框）有足夠大的點擊區域（Touch Target Size）。1.2 單一檔案結構 (Single-File Mandate)HTML/React/Angular 限制: 所有程式碼（HTML/JSX/Template, CSS/Tailwind, JavaScript/TypeScript）必須位於一個單一檔案內。HTML 結構: 將 <style> 標籤放在 <head> 內，並將所有的 <script> 放在 <body> 結束標籤 </body> 之前，以確保 DOM 元素在腳本運行前載入完畢。模組化思考: 即使在單一檔案內，也要使用函數或 React 組件來實現邏輯分離和模組化。2. 樣式與使用者介面 (UI/UX - Tailwind CSS)2.1 響應式佈局 (Responsive Layout)規則說明範例流動性優先避免固定像素寬度，優先使用 w-full, max-w-full 或 w-1/2。<div class="w-full md:w-1/2">...</div>Flex/Grid使用 flex 或 grid 來管理複雜佈局。<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">...</div>Viewport Meta確保 HTML <head> 中包含視口設定，這是響應式設計的基礎。<meta name="viewport" content="width=device-width, initial-scale=1.0">2.2 視覺設計規範 (Aesthetics Standards)配色: 選擇一個主色調 (Primary Color) 並堅持使用其不同深淺，例如使用 indigo-500 作為主要按鈕顏色，indigo-100 作為背景。圓角 (Rounding): 幾乎所有卡片和互動元素都應使用圓角（例如 rounded-xl 或 rounded-lg）。陰影 (Shadows): 適當使用陰影（例如 shadow-md, shadow-xl）來增加元素的立體感和層次感。互動性 (Interaction): 為按鈕添加視覺反饋，如懸停 (hover:)、活動 (active:) 效果，以及平滑的過渡 (transition duration-150)。3. JavaScript 邏輯與功能 (JavaScript/TypeScript)3.1 程式碼品質與結構 (Code Quality)現代 JS (ES6+): 優先使用 const, let, 箭頭函數 (=>), 模板字串 (Template Literals) 和 async/await 處理非同步操作。錯誤處理: 所有的 API 呼叫、數據載入或可能失敗的操作都應使用 try...catch 進行包裝。避免全域污染: 盡量將變數和函數封裝在 IIFE (立即執行函數表達式) 或使用 window.propertyName 來謹慎管理全域範圍。3.2 互動處理 (Interaction Handling)禁止 alert/confirm: 嚴禁使用瀏覽器原生的 alert() 和 confirm()。請使用自訂的 Tailwind 樣式 Modal 或消息框來顯示訊息。非同步操作提示: 在進行耗時操作（例如 Firebase 寫入、LLM 呼叫）時，務必顯示載入指示器或禁用按鈕，防止重複提交。4. 數據與持久化 (Data & Persistence - Firestore)4.1 Firebase 初始化與認證 (Auth Setup)使用提供的全域變數: 始終使用環境提供的 __app_id, __firebase_config 和 __initial_auth_token 進行初始化。自動認證: 必須在啟動時處理認證：如果 __initial_auth_token 存在則用它登入；否則使用 signInAnonymously() 確保應用程式總是有一個 userId。// 示例：Firestore 認證模板
const auth = getAuth(app);
if (typeof __initial_auth_token !== 'undefined') {
    await signInWithCustomToken(auth, __initial_auth_token);
} else {
    await signInAnonymously(auth);
}
// 獲取 userId
const userId = auth.currentUser?.uid || crypto.randomUUID();
4.2 數據路徑規範 (Data Pathing)私有數據 (Private): 用於儲存只有用戶自己能看到的數據。/artifacts/{__app_id}/users/{userId}/{your_collection_name}/{documentId}公開/共享數據 (Public/Shared): 用於協作應用（如聊天、多人遊戲）。/artifacts/{__app_id}/public/data/{your_collection_name}/{documentId}4.3 即時數據處理 (Real-Time Handling)onSnapshot 是核心: 對於所有需要即時更新的數據，必須使用 onSnapshot() 監聽器。這比單純的 getDoc() 更能確保數據的一致性。單獨的 Effect/Listener: 在 React/Angular 中，請將 Firebase 訂閱邏輯放在一個獨立的 useEffect 或生命週期方法中，並確保在 userId 可用後才開始訂閱。4.4 數據結構與限制 (Data Structure)序列化複雜數據: Firestore 無法直接儲存嵌套數組（例如 [[1, 2], [3, 4]]）。在儲存前，必須使用 JSON.stringify() 序列化為字串；讀取後，使用 JSON.parse() 解析。5. 程式碼慣例 (Coding Conventions)慣例說明範例變數命名使用駝峰式 (camelCase)。let currentUserName = 'Gemini';函數命名動詞開頭，描述動作。function updateScore(unitId)Firebase 引用將 Firestore 引用命名為 dataRef 或 unitRef。const unitRef = doc(db, dataPath);註釋 (Comments)使用英文註釋邏輯和複雜的程式碼，使用中文註釋 UI 元素和顯示文字。// Handle the async data fetch錯誤處理所有的 Promise 都應該有 .catch() 或在 async 函數內使用 try...catch。setDoc(...).catch(e => console.error("Save failed", e))
